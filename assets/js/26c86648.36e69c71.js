"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[998],{5117(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Project Overview","title":"Project Overview","description":"Project Goal: To replace existing C2 frameworks for long-haul, Red Team/Offensive management scenarios. This tool serves as a \\"guardian\\" or \\"maintain access\\" solution\u2014the failsafe when primary access methods are detected or neutralized.","source":"@site/docs/Project Overview.md","sourceDirName":".","slug":"/Project Overview","permalink":"/Project Overview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Scripting Overview","permalink":"/03 Scripting/Overview"},"next":{"title":"Quickstart Guide","permalink":"/"}}');var i=t(4848),r=t(8453);const a={},l="Project Overview",o={},c=[{value:"Objectives",id:"objectives",level:2},{value:"Design Choices &amp; Key Features",id:"design-choices--key-features",level:2},{value:"Images",id:"images",level:2},{value:"Command Tree",id:"command-tree",level:2},{value:"Dev Table of Contents",id:"dev-table-of-contents",level:2},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Communication &amp; Data Flow",id:"communication--data-flow",level:3},{value:"Implant Design",id:"implant-design",level:3},{value:"Server Architecture",id:"server-architecture",level:3},{value:"Data Management",id:"data-management",level:3},{value:"Encryption",id:"encryption",level:3},{value:"Management Features",id:"management-features",level:3},{value:"Malleable C2 Support",id:"malleable-c2-support",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"project-overview",children:"Project Overview"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Project Goal:"}),' To replace existing C2 frameworks for long-haul, Red Team/Offensive management scenarios. This tool serves as a "guardian" or "maintain access" solution\u2014the failsafe when primary access methods are detected or neutralized.']}),"\n",(0,i.jsx)(n.p,{children:"While it is not designed to surpass Cobalt Strike or similar C2 tooling as a day-to-day operations tool, LongHaulC2 aims to outperform all of them as a low-overhead management and persistence solution."}),"\n",(0,i.jsx)(n.h2,{id:"objectives",children:"Objectives"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Malleable C2 Interoperability:"})," Leverage existing CS Malleable C2 capabilities and scripts."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Robust Management:"})," Provide a comprehensive API and a user-friendly frontend for operator management."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"design-choices--key-features",children:"Design Choices & Key Features"}),"\n",(0,i.jsx)(n.p,{children:"What makes this suitable for long-haul operations? The entire architecture was built around the idea of surviving for months or years, not just days. This drove a few key design choices:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Granular Profile Binding:"})," Supports distinct Malleable C2 profiles per listener, enabling various traffic signatures across a single campaign infrastructure. A single server can handle multiple disparate profiles."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dynamic Profile Switching:"}),' Implants support multiple communication profiles. Operators can "hot-swap" strategies inline (e.g., changing protocols or Malleable C2 profiles) without spawning new artifacts, significantly reducing the detection surface.']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Automated Rotation:"})," Via the API, operators can script a rotation schedule (e.g., mimic Spotify traffic in the morning, switch to a Slack profile at noon, and switch to a Windows Update profile at night)."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"images",children:"Images"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"(Insert relevant architecture or UI screenshots here)"})}),"\n",(0,i.jsx)(n.h2,{id:"command-tree",children:"Command Tree"}),"\n",(0,i.jsx)(n.p,{children:"Below are the commands and capabilities pulled directly from the Web Client help menu:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://longhaulc2.github.io/02%20Implants/Commands",children:"Command Documentation"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"------\nSystem\n------\nexit                 : Exit the implant. This will kill the implant process on the host, don't expect a response back.\nsleep                : Sleep for a specified number of seconds on the host. Ex: `sleep 5`\n\n-----------\nFile System\n-----------\ncd                   : Change the current working directory on the host. Ex: `cd C:\\Users\\`\nls                   : List the contents of a directory on the host. Ex: `ls C:\\Users\\`\nfile download        : Get a file from the host the implant is running on. Ex: `file download C:\\Users\\user\\file.txt`\nfile upload          : Upload a file to the host. Ex: `file upload C:\\Users\\user\\file.txt <base64_contents>` (or use the UI)\n\n------------\nMemory Store\n------------\nmemstore list        : List all file names in the memstore. Ex: `memstore list`\nmemstore upload      : Upload a file to the implant memstore. Ex: `memstore upload <file_name> <base64_contents>`\nmemstore download    : Download a file from the implant memory store. Ex: `memstore download <file_name>`\nmemstore delete      : Delete a file from the implant's memory store. Ex: `memstore delete <file_name>`\nmemstore clear       : Clear *all* files in the implant's memory store. Ex: `memstore clear`\n\n-----------\nC2 Strategy\n-----------\nstrat active         : List the active strategy for the implant.\nstrat list           : List the available strategies for the implant.\nstrat post           : Set the post strategy for the implant. Ex: `strat post my_post_strategy`\nstrat get            : Set the get strategy for the implant. Ex: `strat get my_get_strategy`\n\n---------\nExecution\n---------\nbof                  : Run a BOF. Ex: `bof <base64_bof_object> <args>` OR from memstore: `bof *memstore_bof_name <args>`\n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"dev-table-of-contents",children:"Dev Table of Contents"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.google.com/search?q=%23longhaulc2-persistent-access-management",children:"Introduction"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.google.com/search?q=%23objectives",children:"Objectives"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.google.com/search?q=%23implementation-details",children:"Implementation Details"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.google.com/search?q=%23malleable-c2-support",children:"Malleable C2 Support"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,i.jsx)(n.h3,{id:"communication--data-flow",children:"Communication & Data Flow"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Serialization:"})," Uses ",(0,i.jsx)(n.strong,{children:"MessagePack"})," for binary data encoding. It offers the structure of JSON but is significantly smaller and faster to parse."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Task Structure:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "task_uuid": "1234",\n    "implant_uuid": "9999",\n    "task": {\n        "task_name": "cmd",\n        "args": {\n            "cli": "whoami"\n        }\n    }\n}\n\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Task Response Structure:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "task_uuid": "1234",\n    "implant_uuid": "9999",\n    "result": {\n        "data_type": "text",\n        "data": "somedomain\\\\bob"\n    }\n}\n\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Metadata Structure:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "implant_uuid": "1234"\n}\n\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Two-Stage Comm Logic:"}),' To minimize noise, the implant separates "status checks" from "data transfer":']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Beacon (The Heartbeat):"})," A lightweight, minimal packet sent periodically to check for pending tasks."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Check-in (The Heavy Lift):"})," A full data connection that opens ",(0,i.jsx)(n.strong,{children:"only"})," when the server confirms tasks are pending. This prevents sending large, suspicious packets when the implant is idle."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"implant-design",children:"Implant Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Language:"})," C++"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Platform Support:"})," Windows-first, with Linux support planned for long-term versatility."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"server-architecture",children:"Server Architecture"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Language:"})," Python (chosen for dynamic restarts, rapid development, and library support)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Management Layer:"})," Built using REST and Flask-RestX to provide a comprehensive API with JSON responses."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"HTTP Listeners:"})," Built with FastAPI. Traffic is defined by Malleable C2 profiles."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"NTP Listeners:"})," Custom socket implementation for NTP tunneling (Planned)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"data-management",children:"Data Management"}),"\n",(0,i.jsx)(n.p,{children:"The backend utilizes a containerized approach for caching and persistent storage."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Redis (Container or External):"})," Acts as a high-performance cache layer. It stores queued commands and caches responses destined for implants."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"MySQL (Container or External):"})," Handles long-term storage and structured data. This includes long-term archival of executed task logs and other critical operational data."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"encryption",children:"Encryption"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status:"})," Not currently implemented."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Plan:"})," Implement the standard asymmetric PKI model for initial key exchange, followed by symmetric encryption for session traffic."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"management-features",children:"Management Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Payload Store:"}),' A server-side repository for payloads to facilitate rapid "re-access" or the spawning of new sessions on compromised hosts.']}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"malleable-c2-support",children:"Malleable C2 Support"}),"\n",(0,i.jsx)(n.p,{children:"LongHaul currently implements the network communication layer of Malleable C2 profiles. It focuses on traffic shaping and indicators (http-get, http-post, etc.), while omitting payload and artifact configurations specific to other frameworks."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>a,x:()=>l});var s=t(6540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);