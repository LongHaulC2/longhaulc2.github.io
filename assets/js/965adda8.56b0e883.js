"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[11],{7904(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"02 Implants/Commands","title":"Commands","description":"This document outlines the available commands for the implant, grouped by functionality.","source":"@site/docs/02 Implants/1. Commands.md","sourceDirName":"02 Implants","slug":"/02 Implants/Commands","permalink":"/02 Implants/Commands","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"test","permalink":"/01 Listeners/test"},"next":{"title":"Modules","permalink":"/02 Implants/Modules/Overview & Modifications"}}');var t=n(4848),i=n(8453);const d={},l="Commands",o={},c=[{value:"Command Tree",id:"command-tree",level:2},{value:"A Note on Command Outputs",id:"a-note-on-command-outputs",level:2},{value:"Technical/API response Structure:",id:"technicalapi-response-structure",level:2},{value:"0. Special Characters",id:"0-special-characters",level:2},{value:"The Dereference Operator (<code>*</code>)",id:"the-dereference-operator-",level:3},{value:"1. System Commands",id:"1-system-commands",level:2},{value:"<code>exit</code>",id:"exit",level:3},{value:"<code>sleep</code>",id:"sleep",level:3},{value:"2. File System Operations",id:"2-file-system-operations",level:2},{value:"<code>cd</code>",id:"cd",level:3},{value:"<code>ls</code>",id:"ls",level:3},{value:"<code>file download</code>",id:"file-download",level:3},{value:"<code>file upload</code>",id:"file-upload",level:3},{value:"3. C2 Strategy",id:"3-c2-strategy",level:2},{value:"<code>strat post</code>",id:"strat-post",level:3},{value:"<code>strat get</code>",id:"strat-get",level:3},{value:"<code>strat list</code>",id:"strat-list",level:3},{value:"<code>strat active</code>",id:"strat-active",level:3},{value:"4. Memory Store",id:"4-memory-store",level:2},{value:"<code>memstore list</code>",id:"memstore-list",level:3},{value:"<code>memstore upload</code>",id:"memstore-upload",level:3},{value:"<code>memstore download</code>",id:"memstore-download",level:3},{value:"<code>memstore delete</code>",id:"memstore-delete",level:3},{value:"<code>memstore clear</code>",id:"memstore-clear",level:3},{value:"5. Execution",id:"5-execution",level:2},{value:"<code>run_bof</code>",id:"run_bof",level:3}];function a(e){const s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"commands",children:"Commands"})}),"\n",(0,t.jsx)(s.p,{children:"This document outlines the available commands for the implant, grouped by functionality."}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"command-tree",children:"Command Tree"}),"\n",(0,t.jsx)(s.p,{children:"Below are the commands and capabilities pulled directly from the Web Client help menu. See below for individual command documentation"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"------\nSystem\n------\nexit                 : Exit the implant. This will kill the implant process on the host, don't expect a response back.\nsleep                : Sleep for a specified number of seconds on the host. Ex: `sleep 5`\n\n-----------\nFile System\n-----------\ncd                   : Change the current working directory on the host. Ex: `cd C:\\Users\\`\nls                   : List the contents of a directory on the host. Ex: `ls C:\\Users\\`\nfile download        : Get a file from the host the implant is running on. Ex: `file download C:\\Users\\user\\file.txt`\nfile upload          : Upload a file to the host. Ex: `file upload C:\\Users\\user\\file.txt <base64_contents>` (or use the UI)\n\n------------\nMemory Store\n------------\nmemstore list        : List all file names in the memstore. Ex: `memstore list`\nmemstore upload      : Upload a file to the implant memstore. Ex: `memstore upload <file_name> <base64_contents>`\nmemstore download    : Download a file from the implant memory store. Ex: `memstore download <file_name>`\nmemstore delete      : Delete a file from the implant's memory store. Ex: `memstore delete <file_name>`\nmemstore clear       : Clear *all* files in the implant's memory store. Ex: `memstore clear`\n\n-----------\nC2 Strategy\n-----------\nstrat active         : List the active strategy for the implant.\nstrat list           : List the available strategies for the implant.\nstrat post           : Set the post strategy for the implant. Ex: `strat post my_post_strategy`\nstrat get            : Set the get strategy for the implant. Ex: `strat get my_get_strategy`\n\n---------\nExecution\n---------\nbof                  : Run a BOF. Ex: `bof <base64_bof_object> <args>` OR from memstore: `bof *memstore_bof_name <args>`\n\n"})}),"\n",(0,t.jsx)(s.h2,{id:"a-note-on-command-outputs",children:"A Note on Command Outputs"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"Traditional Command and Control (C2) frameworks often mix status messages, error codes, and command output into a single text blob. We take a more structured approach to make parsing and automation easier."}),"\n",(0,t.jsx)(s.p,{children:"Every response from the implant is broken down into at least three distinct fields:"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': The raw payload returned by the command. This is the actual "answer" to your task (e.g., a file listing, process list, or file contents).']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": A human-readable status message. This is typically a translation of the Windows API response, for direct transparency as to what is happening on the system, or a custom status message for commands where Windows Errors don't fit."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Ex: ",(0,t.jsx)(s.code,{children:"ERROR_SUCCESS (0)"}),'  becomes "Success", via ',(0,t.jsx)(s.code,{children:"FormatMessage"})," with the ",(0,t.jsx)(s.code,{children:"FORMAT_MESSAGE_FROM_SYSTEM"})," flag"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Ex:  ",(0,t.jsx)(s.code,{children:"5"})," becomes ",(0,t.jsx)(s.code,{children:"Access Denied"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["See ",(0,t.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-formatmessage",children:"FormatMessage function (winbase.h)"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The specific Windows API error code or internal return value. Useful for debugging or programmatic handling of errors."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/windows/win32/debug/system-error-codes--0-499-",children:"System Error Codes (0-499)"})}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Additional fields may be included as well, for tasks where there are multiple outputs:"}),"\n",(0,t.jsx)(s.p,{children:"Example:"}),"\n",(0,t.jsxs)(s.p,{children:["Strat active returns a ",(0,t.jsx)(s.code,{children:"comms_get_strategy"}),", and a ",(0,t.jsx)(s.code,{children:"comms_post_strategy"}),". These variations will be noted in the documentation below"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"019c62bb > strat active\n--- comms_get_strategy ---\nhttp_get_10_0_0_30_9090_aabb\n--- comms_post_strategy ---\nhttp_post_10_0_0_30_9090_aabb\n"})}),"\n",(0,t.jsx)(s.h2,{id:"technicalapi-response-structure",children:"Technical/API response Structure:"}),"\n",(0,t.jsx)(s.p,{children:"For reference - this is the structure of the task response, with the values listed above. If you aren't using the API, don't worry about this.\nMore details can be found in the API docs (link those when done...)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'{\n  "task_uuid": "00000000-0000-0000-0000-000000000000",\n  "implant_uuid": "00000000-0000-0000-0000-000000000000",\n  "result": {\n    "message": {\n      "type": "text",\n      "value": "Success"\n    },\n    "data": {\n      "type": "text",       # or bytes, if content contains binary data.\n      "value": "some_data" \n    }\n    "windows_error_code": {\n      "type": "text",\n      "value": "0"\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(s.h2,{id:"0-special-characters",children:"0. Special Characters"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"A collection of special characters, and what they mean."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"*"})})}),(0,t.jsx)(s.td,{children:'"de-ref", used to access a file from the memory store in the command'})]})})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsxs)(s.h3,{id:"the-dereference-operator-",children:["The Dereference Operator (",(0,t.jsx)(s.code,{children:"*"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:["The dereference operator (",(0,t.jsx)(s.code,{children:"*"}),") lets you use ",(0,t.jsx)(s.em,{children:"binary"})," data from the implant's memory store system as a command argument, to any input that takes binary (or base64) data."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"WARNING: BINARY DATA ONLY: The dereference operator is designed exclusively for handling raw binary blobs (e.g., executables, shellcode). This makes it great for commands that take raw data, but not suitable for text data. The system treats referenced data as raw bytes; attempting to use text will result in illegible garbage output, or unexpected crashes."}),"\n"]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["Note, this syntax is only currently supported on the ",(0,t.jsx)(s.code,{children:"file upload"}),", and ",(0,t.jsx)(s.code,{children:"bof"})," commands."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"How is this useful"})}),"\n",(0,t.jsxs)(s.p,{children:["The deref operator has a few advantages, mainly by allowing you to transfer a tool or payload ",(0,t.jsx)(s.em,{children:"once"})," and deploy it multiple times from memory, rather than re-sending the same data over the network for every operation. Granted, there is a tradeoff, increased memory useage on the implant to store the data."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"<command> *<arg> \n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Example"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"File Upload:"})}),"\n",(0,t.jsx)(s.p,{children:"A traditional file upload:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"file upload C:\\Temp\\not_malware.exe <base64_blob>\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Dereferenced Upload:"})}),"\n",(0,t.jsxs)(s.p,{children:["If ",(0,t.jsx)(s.code,{children:"my_payload"})," is already in the memory store, this will pull that data, and write to the said file."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"file upload C:\\Temp\\not_malware.exe *my_payload\n"})}),"\n",(0,t.jsx)(s.h2,{id:"1-system-commands",children:"1. System Commands"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"Control the state and execution of the implant process itself."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"exit"})})}),(0,t.jsx)(s.td,{children:"Terminate the implant process on the host."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"sleep"})})}),(0,t.jsx)(s.td,{children:"Sleep for a specified number of seconds on the host."})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"exit",children:(0,t.jsx)(s.code,{children:"exit"})}),"\n",(0,t.jsx)(s.p,{children:"Exits the implant execution."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"This kills the implant process on the host. Do not expect a response confirmation from the implant after this command is issued."}),"\n"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"exit"})]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Return Values"}),":"]}),"\n",(0,t.jsx)(s.p,{children:"Does not return."}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"sleep",children:(0,t.jsx)(s.code,{children:"sleep"})}),"\n",(0,t.jsx)(s.p,{children:"Updates the implant sleep value, to a specified number of seconds."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"sleep <seconds>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sleep 5\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": Sleep time that the implant was updated to"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"2-file-system-operations",children:"2. File System Operations"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"Interact with files on the host's disk."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"cd"})})}),(0,t.jsx)(s.td,{children:"Change the current working directory on the host."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"ls"})})}),(0,t.jsx)(s.td,{children:"List the contents of a directory on the host."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"file download"})})}),(0,t.jsx)(s.td,{children:"Download a file from the host machine to the server."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"file upload"})})}),(0,t.jsx)(s.td,{children:"Upload a file from the server to the host machine."})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"cd",children:(0,t.jsx)(s.code,{children:"cd"})}),"\n",(0,t.jsx)(s.p,{children:"Changes the current working directory on the host machine."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"cd <directory>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cd C:\\Users\\\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"ls",children:(0,t.jsx)(s.code,{children:"ls"})}),"\n",(0,t.jsxs)(s.p,{children:["Lists the contents of a directory on the host. If no directory is provided, it defaults to the current working directory (",(0,t.jsx)(s.code,{children:"."}),")."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"ls [directory]"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"ls C:\\Users\\\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": A newline (",(0,t.jsx)(s.code,{children:"\\n"}),") separated list of files and directories in the listed directory. If using the api, split by ",(0,t.jsx)(s.code,{children:"\\n"}),"."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Ex: ",(0,t.jsx)(s.code,{children:"ls_output = data.split(\\n)"})]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"file-download",children:(0,t.jsx)(s.code,{children:"file download"})}),"\n",(0,t.jsx)(s.p,{children:"Retrieves a file from the host machine where the implant is running."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"file download <file_path>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"file download C:\\Users\\user\\file.txt\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": The file contents of the file retrieved from the system. Via the GUI, this is printed to the screen as base64."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"file-upload",children:(0,t.jsx)(s.code,{children:"file upload"})}),"\n",(0,t.jsx)(s.p,{children:"Uploads a file to the host machine."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Note: When using the GUI, input file contents as a Base64 string. The interface automatically decodes this to binary before serializing the task into MessagePack. If you are using the API directly, you can construct the MessagePack task using raw binary."}),"\n"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"file upload <file_path> <base64_content>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"file upload C:\\Users\\user\\file.txt <base64_file_contents>\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"3-c2-strategy",children:"3. C2 Strategy"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"Manage how the implant communicates with the C2 server."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"strat post"})})}),(0,t.jsx)(s.td,{children:'Set the "post" strategy (data exfiltration method).'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"strat get"})})}),(0,t.jsx)(s.td,{children:'Set the "get" strategy (task retrieval method).'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"strat list"})})}),(0,t.jsx)(s.td,{children:"List all available strategies on the implant."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"strat active"})})}),(0,t.jsx)(s.td,{children:"List the currently active strategies."})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"strat-post",children:(0,t.jsx)(s.code,{children:"strat post"})}),"\n",(0,t.jsx)(s.p,{children:"Sets the posting strategy (how the implant sends data back)."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"strat post <strategy_name>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"strat post my_post_strategy\n\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"strat-get",children:(0,t.jsx)(s.code,{children:"strat get"})}),"\n",(0,t.jsx)(s.p,{children:"Sets the getting strategy (how the implant retrieves tasks)."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"strat get <strategy_name>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"strat get my_get_strategy\n\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"strat-list",children:(0,t.jsx)(s.code,{children:"strat list"})}),"\n",(0,t.jsx)(s.p,{children:"Lists the available strategies configured on the implant."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"strat list"})]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"strat-active",children:(0,t.jsx)(s.code,{children:"strat active"})}),"\n",(0,t.jsx)(s.p,{children:"Displays the currently active strategies."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"strat active"})]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Custom fields:"})}),"\n",(0,t.jsx)(s.p,{children:"This command returns specific key-value pairs in the response object. This structure is preferred over newline-delimited strings in the data field, as it allows the UI and API to parse active strategies reliably without ambiguity."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"comms_get_strategy"}),": The name of the active Ingress strategy (the method the implant uses to retrieve tasks)."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"comms_post_strategy"}),": The name of the active Egress strategy (the method the implant uses to exfiltrate data)."]}),"\n",(0,t.jsx)(s.p,{children:"Ex:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"019c62bb > strat active\n--- comms_get_strategy ---\nhttp_get_10_0_0_30_9090_aabb\n--- comms_post_strategy ---\nhttp_post_10_0_0_30_9090_aabb\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"4-memory-store",children:"4. Memory Store"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"Interact with the implant's volatile memory storage (RAM-only file system). See MemoryStore docs for additional implementation info."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"memstore list"})})}),(0,t.jsx)(s.td,{children:"List all filenames currently in the memory store."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"memstore upload"})})}),(0,t.jsx)(s.td,{children:"Upload a file into the implant's internal memory store."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"memstore download"})})}),(0,t.jsx)(s.td,{children:"Download a file from the implant's internal memory store."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"memstore delete"})})}),(0,t.jsx)(s.td,{children:"Delete a specific file from the memory store."})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"memstore clear"})})}),(0,t.jsxs)(s.td,{children:["Clear ",(0,t.jsx)(s.em,{children:"all"})," files from the memory store."]})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"memstore-list",children:(0,t.jsx)(s.code,{children:"memstore list"})}),"\n",(0,t.jsx)(s.p,{children:"Lists the names of all files currently stored in the memory store."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"memstore list"})]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": All files in the memstore, by name, that are compiled into the implant. Separated via newlines (",(0,t.jsx)(s.code,{children:"\\n"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"memstore-upload",children:(0,t.jsx)(s.code,{children:"memstore upload"})}),"\n",(0,t.jsx)(s.p,{children:"Uploads a file directly to the implant's volatile memory store (RAM). Useful for staging files without touching the disk."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Note: When using the GUI, input file contents as a Base64 string. The interface automatically decodes this to binary before serializing the task into MessagePack. If you are using the API directly, you can construct the MessagePack task using raw binary."}),"\n"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"memstore upload <file_name> <base64_content>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"memstore upload my_tool.exe aabbcc==\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"memstore-download",children:(0,t.jsx)(s.code,{children:"memstore download"})}),"\n",(0,t.jsx)(s.p,{children:"Retrieves a file from the implant's memory store."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"memstore download <file_name>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"memstore download some_file_in_memstore\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": The file contents of the file retrieved from the memstore. Via the GUI, this is printed to the screen as base64."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"memstore-delete",children:(0,t.jsx)(s.code,{children:"memstore delete"})}),"\n",(0,t.jsx)(s.p,{children:"Removes a specific file from the implant's memory store."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"memstore delete <file_name>"})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"memstore delete not_more_malware\n\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"memstore-clear",children:(0,t.jsx)(s.code,{children:"memstore clear"})}),"\n",(0,t.jsx)(s.p,{children:"Wipes all files from the memory store."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:"memstore clear"})]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),': "" (Nothing, empty string)']}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": Windows Error Code translated via FormatMessage"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The resulting Windows Error Code"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"5-execution",children:"5. Execution"}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.p,{children:"The Host Execution commands provide operators with various mechanisms to run commands, payloads, and post-exploitation tools directly on a compromised target."}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Command"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"run_bof"})})}),(0,t.jsx)(s.td,{children:"Load, initialize, and execute a compiled BOF in memory and return its standard output."})]})})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"run_bof",children:(0,t.jsx)(s.code,{children:"run_bof"})}),"\n",(0,t.jsx)(s.p,{children:"Executes a compiled Beacon Object File (BOF) within the implant's process space. The command takes the raw BOF object code, packs the provided arguments into the BOF's required structure, executes the entry point, and captures the resulting standard output before safely cleaning up the execution context."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Note: When using this command via the API or GUI, ensure the BOF bytes are properly passed (e.g., via base64 in the CLI or an existing memory store artifact) along with the argument string."}),"\n"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Usage:"})," ",(0,t.jsx)(s.code,{children:'run_bof <bof_file> "<arguments>"'})]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.strong,{children:"Example:"})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'run_bof *enumerate_domain "-domain contoso.local"\n\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Return Values"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"data"}),": A string containing the captured standard output from the BOF execution. Returns empty (",(0,t.jsx)(s.code,{children:'""'}),") if execution failed or there was no output."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"message"}),": A descriptive error message corresponding to the resulting Windows Error Code."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"windows_error_code"}),": The status code resulting from the execution attempt. Expected codes include:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsxs)(s.strong,{children:[(0,t.jsx)(s.code,{children:"0"})," (",(0,t.jsx)(s.code,{children:"ERROR_SUCCESS"}),")"]}),": The BOF executed and output was successfully retrieved."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"ERROR_INTERNAL_ERROR"})}),": The BOF launcher failed to initialize, or the BOF failed to execute."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"ERROR_BAD_FORMAT"})}),": The provided BOF bytes could not be parsed or loaded from memory."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"ERROR_OUTOFMEMORY"})}),": The argument structure failed to initialize."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"ERROR_UNIDENTIFIED_ERROR"})}),": The BOF finished, but no output string could be retrieved from the context."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453(e,s,n){n.d(s,{R:()=>d,x:()=>l});var r=n(6540);const t={},i=r.createContext(t);function d(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);