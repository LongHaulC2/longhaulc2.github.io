"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[9632],{3226(e,n,s){s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"02 Implants/Modules/metadata.cpp","title":"Module: get_current_user (User Discovery)","description":"Source: src/modules/metadata.cpp","source":"@site/docs/02 Implants/Modules/04. metadata.cpp.md","sourceDirName":"02 Implants/Modules","slug":"/02 Implants/Modules/metadata.cpp","permalink":"/docs/02 Implants/Modules/metadata.cpp","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02 Implants/Modules/04. metadata.cpp.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Module: files (File I/O)","permalink":"/docs/02 Implants/Modules/files.cpp"},"next":{"title":"Module: run_bof (Run Beacon Object File)","permalink":"/docs/02 Implants/Modules/BOF.cpp"}}');var l=s(4848),i=s(8453);const c={},d="Module: get_current_user (User Discovery)",t={},o=[{value:"Function Signature",id:"function-signature",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Logic &amp; Behavior",id:"logic--behavior",level:3},{value:"Return Values (<code>ModuleResult</code>)",id:"return-values-moduleresult",level:3},{value:"Function Signature",id:"function-signature-1",level:3},{value:"Parameters",id:"parameters-1",level:3},{value:"Logic &amp; Behavior",id:"logic--behavior-1",level:3},{value:"Return Values (<code>ModuleResult</code>)",id:"return-values-moduleresult-1",level:3},{value:"Function Signature",id:"function-signature-2",level:3},{value:"Parameters",id:"parameters-2",level:3},{value:"Logic &amp; Behavior",id:"logic--behavior-2",level:3},{value:"Return Values (<code>ModuleResult</code>)",id:"return-values-moduleresult-2",level:3},{value:"Function Signature",id:"function-signature-3",level:3},{value:"Parameters",id:"parameters-3",level:3},{value:"Logic &amp; Behavior",id:"logic--behavior-3",level:3},{value:"Return Values (<code>ModuleResult</code>)",id:"return-values-moduleresult-3",level:3},{value:"Function Signature",id:"function-signature-4",level:3},{value:"Parameters",id:"parameters-4",level:3},{value:"Logic &amp; Behavior",id:"logic--behavior-4",level:3},{value:"Return Values (<code>ModuleResult</code>)",id:"return-values-moduleresult-4",level:3}];function a(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsxs)(n.h1,{id:"module-get_current_user-user-discovery",children:["Module: ",(0,l.jsx)(n.code,{children:"get_current_user"})," (User Discovery)"]})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source:"})," ",(0,l.jsx)(n.code,{children:"src/modules/metadata.cpp"})]}),"\n",(0,l.jsx)(n.p,{children:"This module identifies the user account context in which the implant is currently executing."}),"\n",(0,l.jsx)(n.h3,{id:"function-signature",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"ModuleResult get_current_user();\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"None"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"logic--behavior",children:"Logic & Behavior"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Buffer Allocation"}),": Allocates a buffer of size ",(0,l.jsx)(n.code,{children:"UNLEN + 1"})," (standard Windows constant for max username length)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Call"}),": Calls ",(0,l.jsx)(n.code,{children:"GetUserNameW"})," to retrieve the wide-character username."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Encoding Conversion"}),":"]}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Instead of using verbose ",(0,l.jsx)(n.code,{children:"WideCharToMultiByte"})," routines, it leverages ",(0,l.jsx)(n.code,{children:"std::filesystem::path"})," as a robust converter to transform the ",(0,l.jsx)(n.code,{children:"wchar_t"})," buffer into a standard UTF-8 ",(0,l.jsx)(n.code,{children:"std::string"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Error Handling"}),": Returns ",(0,l.jsx)(n.code,{children:"GetLastError()"})," if the API call fails."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"return-values-moduleresult",children:["Return Values (",(0,l.jsx)(n.code,{children:"ModuleResult"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"data"})}),": The username string (e.g., ",(0,l.jsx)(n.code,{children:"Administrator"})," or ",(0,l.jsx)(n.code,{children:"SYSTEM"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"windows_error_code"})}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_SUCCESS"})," (0): Retrieval successful."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WinAPI Error"}),": If the buffer is too small or access is denied."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.h1,{id:"module-get_computer_name-hostname-discovery",children:["Module: ",(0,l.jsx)(n.code,{children:"get_computer_name"})," (Hostname Discovery)"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source:"})," ",(0,l.jsx)(n.code,{children:"src/modules/metadata.cpp"})]}),"\n",(0,l.jsx)(n.p,{children:"Retrieves the NetBIOS name of the local computer."}),"\n",(0,l.jsx)(n.h3,{id:"function-signature-1",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"ModuleResult get_computer_name();\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"None"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"logic--behavior-1",children:"Logic & Behavior"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Buffer Allocation"}),": Allocates a buffer based on ",(0,l.jsx)(n.code,{children:"MAX_COMPUTERNAME_LENGTH"})," (typically 15 characters for NetBIOS names)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Call"}),": Calls ",(0,l.jsx)(n.code,{children:"GetComputerNameW"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Encoding Conversion"}),": Uses the ",(0,l.jsx)(n.code,{children:"std::filesystem::path"})," trick to safely convert the wide string to a standard string without corruption."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"return-values-moduleresult-1",children:["Return Values (",(0,l.jsx)(n.code,{children:"ModuleResult"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"data"})}),": The hostname (e.g., ",(0,l.jsx)(n.code,{children:"DESKTOP-12345"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"windows_error_code"})}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_SUCCESS"})," (0): Retrieval successful."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WinAPI Error"}),": Relevant error code on failure."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.h1,{id:"module-get_current_process_name-process-context",children:["Module: ",(0,l.jsx)(n.code,{children:"get_current_process_name"})," (Process Context)"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source:"})," ",(0,l.jsx)(n.code,{children:"src/modules/metadata.cpp"})]}),"\n",(0,l.jsxs)(n.p,{children:["Identifies the full path of the executable currently hosting the implant. This is useful for verifying if the implant has been successfully injected into a target process (like ",(0,l.jsx)(n.code,{children:"notepad.exe"}),") or is running as a standalone artifact."]}),"\n",(0,l.jsx)(n.h3,{id:"function-signature-2",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"ModuleResult get_current_process_name();\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameters-2",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"None"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"logic--behavior-2",children:"Logic & Behavior"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Buffer Allocation"}),": Allocates a large heap vector (",(0,l.jsx)(n.code,{children:"32767"})," chars) to accommodate potential Windows extended paths (",(0,l.jsx)(n.code,{children:"\\\\?\\"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Call"}),": Calls ",(0,l.jsx)(n.code,{children:"GetModuleFileNameW"}),", passing ",(0,l.jsx)(n.code,{children:"NULL"})," to indicate the current process."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Validation"}),":"]}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Checks if the return length matches the buffer size (indicating ",(0,l.jsx)(n.code,{children:"ERROR_INSUFFICIENT_BUFFER"}),")."]}),"\n",(0,l.jsx)(n.li,{children:"Checks for a 0 return value (generic failure)."}),"\n"]}),"\n",(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Conversion"}),": Converts the resulting path to a standard string."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"return-values-moduleresult-2",children:["Return Values (",(0,l.jsx)(n.code,{children:"ModuleResult"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"data"})}),": The full path to the executable (e.g., ",(0,l.jsx)(n.code,{children:"C:\\Windows\\System32\\svchost.exe"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"windows_error_code"})}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_SUCCESS"})," (0): Success."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_INSUFFICIENT_BUFFER"}),": If the path exceeds the allocated vector size."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_INVALID_DATA"}),": If string conversion fails."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.h1,{id:"module-get_current_process_pid-process-id",children:["Module: ",(0,l.jsx)(n.code,{children:"get_current_process_pid"})," (Process ID)"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source:"})," ",(0,l.jsx)(n.code,{children:"src/modules/metadata.cpp"})]}),"\n",(0,l.jsx)(n.p,{children:"Retrieves the unique Process ID (PID) assigned to the implant by the OS."}),"\n",(0,l.jsx)(n.h3,{id:"function-signature-3",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"ModuleResult get_current_process_pid();\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameters-3",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"None"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"logic--behavior-3",children:"Logic & Behavior"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Call"}),": Calls ",(0,l.jsx)(n.code,{children:"GetCurrentProcessId()"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Conversion"}),": Converts the resulting ",(0,l.jsx)(n.code,{children:"DWORD"})," (integer) into a ",(0,l.jsx)(n.code,{children:"std::string"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"return-values-moduleresult-3",children:["Return Values (",(0,l.jsx)(n.code,{children:"ModuleResult"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"data"})}),": The PID as a string (e.g., ",(0,l.jsx)(n.code,{children:"4520"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"windows_error_code"})}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ERROR_SUCCESS"})," (0): Always returns success"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.h1,{id:"module-get_ip_address-network-discovery",children:["Module: ",(0,l.jsx)(n.code,{children:"get_ip_address"})," (Network Discovery)"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source:"})," ",(0,l.jsx)(n.code,{children:"src/modules/metadata.cpp"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:"Current Status: Placeholder"})}),"\n",(0,l.jsx)(n.p,{children:"Intended to resolve the internal IP address of the host."}),"\n",(0,l.jsx)(n.h3,{id:"function-signature-4",children:"Function Signature"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"ModuleResult get_ip_address();\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameters-4",children:"Parameters"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"None"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"logic--behavior-4",children:"Logic & Behavior"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Currently returns a static placeholder string."}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.em,{children:"Future Implementation:"})," Will likely utilize ",(0,l.jsx)(n.code,{children:"GetAdaptersInfo"})," or ",(0,l.jsx)(n.code,{children:"gethostname"})," / ",(0,l.jsx)(n.code,{children:"getaddrinfo"})," to resolve the active interface address."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"return-values-moduleresult-4",children:["Return Values (",(0,l.jsx)(n.code,{children:"ModuleResult"}),")"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"data"})}),": Currently static ",(0,l.jsx)(n.code,{children:'"someip"'}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"windows_error_code"})}),": ",(0,l.jsx)(n.code,{children:"ERROR_SUCCESS"})," (0)."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>c,x:()=>d});var r=s(6540);const l={},i=r.createContext(l);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);